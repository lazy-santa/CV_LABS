#   Лабораторная работа №1 по дисциплине "Системы копьютерного зрения"
##  Задание
&ensp; В рамках данной работы было необходимо реализовать следующие функции:
1. Фильтр Гаусса
2. Медианый фильтр
3. Эрозия
4. Дилатация
5. Корректировка освещения
6. Бинаризация

В качестве тестового изображения было взято изображение разрешением (1920,1080), в дальнейшем уменьшенное до (640,360).
![image.jpg](https://naked-science.ru/wp-content/uploads/2020/01/mrbean_1.jpg)

##  Размерность итогового и начального изображения
&ensp; Так как в проекте применяются фильтры, основанные на методе свёртке изображений, то размерность итогового изображения всегда меньше начального. Однако, для того, чтобы сохранить размерность итогового изображения необходимо предварительно увеличить размер начального изображения так, чтобы после проведения свёртки получившиеся изображение имело размер начального.
  
&ensp; Для этого необходимо увеличивать исходное изображение на величину радиуса свертки *(d-1)/2* (где d - сторона квадратного ядра свёртки).
  
## Фильтры

### Фильтр Гаусса
&ensp;Гауссовский фильтр (размытие по Гауссу) — это низкочастотный фильтр, который сглаживает неравномерные значения пикселей изображения, обрезая самые высокие значения. Основная задача фильтра — сглаживать изображение, уменьшая шум и устраняя ненужные детали, которые могут мешать анализу. 

&ensp; Он основан на математической функции Гаусса (или нормального распределения), которая определяет веса, применяемые к пикселям в окрестности каждого элемента изображения.

![изображение](https://github.com/user-attachments/assets/5d20836f-71cb-4f03-a4c5-67408d908dec)

&ensp; Работа функции фильтра Гаусса состоит из следующих этапов:
1. Создание ядра Гаусса заданного размера, где веса пикселей уменьшаются по мере удаления от центра по гауссовскому закону
2. Добавления дополнительных пикселей вокруг исходного изображения на радиус ядра свертки (Паддинг)
3. Применение ядра к каждому пикселю изображения через операцию свёртки*

*Свёртка изображения — это математическая операция, которая позволяет применять ядро** (или фильтр) к каждому пикселю изображения, чтобы получить новое изображение с изменёнными свойствами.

**Ядро свёртки (или фильтр) — это матрица коэффициентов, которая перемещается по изображению с определённым шагом (шаг свёртки). Каждый элемент ядра умножается на соответствующий элемент изображения, на котором оно находится, а затем все эти произведения суммируются. Этот процесс повторяется для каждой позиции ядра на изображении, пока всё изображение не будет пройдено свёрткой.

&ensp; Ключевые параметры фильтра:
- Размер ядра (kernel_size): определяет область влияния вокруг каждого пикселя
- Стандартное отклонение (sigma): контролирует степень размытия - чем больше sigma, тем сильнее размытие

&ensp; Результат работы данного фильтра представлен на изображении ниже.
![Без имени](https://github.com/user-attachments/assets/3342f551-2d39-40d2-99b1-2c9f73c2f9b1)![Без имени-1](https://github.com/user-attachments/assets/1273f4a0-e181-4451-87af-7e328b220414)


### Медианный фильтр
&ensp;  Медианный фильтр - это нелинейный фильтр, который эффективно удаляет импульсный шум (например, "соль и перец") при сохранении четких границ объектов. В отличие от гауссовского фильтра, который использует взвешенное среднее, медианный фильтр заменяет значение пикселя на медиану значений в его окрестности.

&ensp; Работа фильтра состоит из следующих этапов:
1. Создание окна (ядра) заданного размера
2. Добавления дополнительных пикселей вокруг исходного изображения на радиус ядра свертки (Паддинг)
3. Для каждого пикселя изображения:
   - Выбор всех пикселей в окрестности (включая сам пиксель)
   - Сортировка значений пикселей в окрестности
   - Выбор среднего значения из отсортированного списка
   - Замена значения центрального пикселя на найденную медиану

&ensp; Ключевые параметры фильтра:
- Размер ядра (kernel_size): определяет область, в которой ищется медиана

&ensp; Результат работы данного фильтра представлен на изображении ниже.
![Без имени](https://github.com/user-attachments/assets/3342f551-2d39-40d2-99b1-2c9f73c2f9b1)![Без имени](https://github.com/user-attachments/assets/fe21eefb-d91f-44ae-8052-3cdd902e0f90)

## Морфологические операции
### Эрозия
&ensp; Эрозия - это базовая морфологическая операция, которая "сжимает" или "уменьшает" объекты на изображении. Данный фильтр основан на поиске наиболее тёмного пикселя в области ядра свёртки, после чего присваивать найденное значение центральному пикселю ядра свёртки. Фактически, результатом работы является выбор наиболее тёмного пикселя в определённой области. Как правило, после данного фильтра изображения получают эффект размытия с выделением тёмных участков изображения (все тёмные участки становятся больше по размерам и более ярко выраженными).

&ensp; Ключевые параметры фильтра:
- Размер ядра (kernel_size): определяет область поиска минимального значения 

&ensp; Результат работы данной операции (с размером окна kernel_size=11) представлен на изображении ниже.
![Без имени](https://github.com/user-attachments/assets/3342f551-2d39-40d2-99b1-2c9f73c2f9b1)![Без имени](https://github.com/user-attachments/assets/b61382a9-613d-4c04-8021-092df409a60e)

### Дилатация
&ensp; Дилатация - это морфологическая операция, обратная эрозии, которая "расширяет" или "увеличивает" объекты на изображении. Принцип работы основан на поиске максимального значения пикселя в заданной окрестности (ядре) и присваивании этого значения центральному пикселю. Это делает итоговое изображение более светлым и с более светлыми цветами. 

&ensp; Ключевые параметры операции:
- Размер ядра (kernel_size): определяет область поиска максимального значения

&ensp; Результат работы данной операции (с размером окна kernel_size=7) представлен на изображении ниже.
![Без имени](https://github.com/user-attachments/assets/3342f551-2d39-40d2-99b1-2c9f73c2f9b1)![Без имени-1](https://github.com/user-attachments/assets/9bec9b9a-323d-4d63-ab42-0202a79b70db)

## Бинаризация
&ensp; Бинаризация - это процесс преобразования изображения в бинарное (двухцветное) представление, где каждый пиксель принимает одно из двух возможных значений: минимальное (0) или максимальное (255). Решение о переводе пикселя в максимальное или минимальное состояние основывается на том, больше он или меньше чем пороговое значение.

&ensp; Работа операции состоит из следующих этапов:
1. Инициализируем будущее бинаризованное изображение значениями всех пикселей равным (255)
2. Для каждого пикселя каждого канала RGB исходного изображения:
   - Сравнение значений каждого канала с соответствующим порогом
   - Если хотя бы один канал ниже порога, пиксель на будущем изображениии становится черным (0)
   - В противном случае пиксель остается белым (255)
   - 
&ensp; Ключевые параметры операции:
- Пороговые значения (threshold): кортеж из трех значений для каждого цветового канала (R, G, B)

&ensp; Результат работы данной операции представлен на изображении ниже.
![Без имени](https://github.com/user-attachments/assets/f76ecdab-4d58-4a41-8649-09c3cd0f265f)

## Коррекция освещения
&ensp; Работа операции состоит из следующих этапов:
1. Перевод изображения в формат HSV
2. Извлекаем канал яркости (Value) из HSV изображения
3. Строим гистограмму значений яркости
4. Вычисляем кумулятивную функцию распределения (CDF)
5. Нормализуем CDF в диапазон [0, 255]
6. Выполняем интерполяцию значений яркости в распределении (0,255)
7. Возращаем обратно в цветовой формат BGR

&ensp; Результат работы данной операции представлен на изображении ниже.
![Без имени](https://github.com/user-attachments/assets/3342f551-2d39-40d2-99b1-2c9f73c2f9b1)![Без имени](https://github.com/user-attachments/assets/3341c4be-17a7-4630-9486-ceb71854b5b1)

## Результаты работы
&ensp; В рамках данной работы были изучены теорретически и реализованы в коде фильтры изображений, согласно поставленной задач.

&ensp; Все результаты работы были оформлены в проекте на платформе GitHub, при этом сам код фильтров был реализован на платформе Colab ([Файл](CV_LAB1.ipynb) с кодами содержится в репрезитории на GitHub).
