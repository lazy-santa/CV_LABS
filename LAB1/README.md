#   Лабораторная работа №1 по дисциплине "Системы копьютерного зрения"
##  Задание
&ensp; В рамках данной работы было необходимо реализовать следующие функции:
1. Фильтр Гаусса
2. Медианый фильтр
3. Эрозия
4. Дилатация
5. Корректировка освещения
6. Бинаризация

В качестве тестового изображения было взято изображение разрешением (1920,1080), в дальнейшем уменьшенное до (640,360).
![image.jpg](https://naked-science.ru/wp-content/uploads/2020/01/mrbean_1.jpg)

##  Размерность итогового и начального изображения
&ensp; Так как в проекте применяются фильтры, основанные на методе свёртке изображений, то размерность итогового изображения всегда меньше начального. Однако, для того, чтобы сохранить размерность итогового изображения необходимо предварительно увеличить размер начального изображения так, чтобы после проведения свёртки получившиеся изображение имело размер начального.
  
&ensp; Для этого необходимо увеличивать исходное изображение на величину радиуса свертки *(d-1)/2* (где d - сторона квадратного ядра свёртки).
  
## Фильтры

### Гаусовый
&ensp;Гауссовский фильтр (размытие по Гауссу) — это низкочастотный фильтр, который сглаживает неравномерные значения пикселей изображения, обрезая самые высокие значения. Основная задача фильтра — сглаживать изображение, уменьшая шум и устраняя ненужные детали, которые могут мешать анализу. 

&ensp; Он основан на математической функции Гаусса (или нормального распределения), которая определяет веса, применяемые к пикселям в окрестности каждого элемента изображения.
image.png

&ensp; Работа фильтра состоит из следующих этапов:
1. Создание ядра Гаусса заданного размера, где веса пикселей уменьшаются по мере удаления от центра по гауссовскому закону
2. Нормализация ядра (сумма всех весов равна 1)
3. Применение ядра к каждому пикселю изображения через операцию свёртки

&ensp; Ключевые параметры фильтра:
- Размер ядра (kernel_size): определяет область влияния вокруг каждого пикселя
- Стандартное отклонение (sigma): контролирует степень размытия - чем больше sigma, тем сильнее размытие

&ensp; Особенности работы:
- Центральные пиксели имеют наибольший вес в расчете нового значения
- Влияние удаленных пикселей экспоненциально уменьшается
- Фильтр сохраняет основные контуры объектов, но удаляет мелкие детали и шум
- Эффективно работает с гауссовским шумом


&ensp; Данный фильтр часто используется для размытия изображений и сглаживания, однако для этого чаще всего применяются ядра свёртки, коэффициенты в котором рисуют круг/окружность, однако и прямоугольные ядра свёртки дают схожий результат. 

&ensp; Значение пикселя, в итоге, определяется суммой значений соседних пикселей, после их домножения на коэффициенты ядра свёртки. Стоит заметить, что арспределение коэффициентов может быть различно, чаще всего стараются придать максимальное значение центральному пикселю и после влияние пикселей резко идёт на спад. Данное распределение позволяет сохранить большую часть информации исходного пикселя. Однако, если в ядре свёртки соседние от центрального пикселя будут иметь большие коэффициенты влияния, не исключены ситуации, что центральный пиксель будет уже во многом определяться не центральным, исходным, а его окрестностью, что может привести к сильному размытию краёв объектов на изображении.

&ensp; Результат работы данного фильтра представлен на изображении ниже.

### Медианный
&ensp; Данный фильтр работает следующим образом: в ядре свёртки анализируются все имеющиеся значения, после чего выстраиваются в список по возрастанию или убыванию (не имеет значение), после чего берётся среднее значение (назодящиеся в центре ряда (такое число гарантированно есть, так как при размери квадратной сетки с нечётным числом всегда будет одно единственное значение, являющиеся центром ряда). Значение пикселя в центре ядра свёртки будет значение в центре полученного численного ряда.
&ensp; Результат работы данного фильтра представлен на изображении ниже.

## Морфологические операции
### Эрозия
&ensp; Данный фильтр основан на поиске наиболее тёмного пикселя в области ядра свёртки, после чего присваивать найденное значение центральному пикселю ядра свёртки. Фактически, результатом работы является выбор наиболее тёмного пикселя в определённой области. Как правило, после данного фильтра изображения получают эффект размытия с выделением тёмных участков изображения (все тёмные участки становятся больше по размерам и более ярко выраженными).

### Диалотация
&ensp; Данный фильтр работает аналогично предыдущему (эрозии), но с той разницей, что в ядре свёртки ищется не самый тёмный пиксель, а самый светлый. Что, фактически, делает итоговое изображение более светлым и с более светлыми цветами. 
&ensp; Результат работы данного фильтра представлен на изображении ниже.

## Корректировка освещения (коэффициент)
&ensp; Данный мето доснован на том, что каждый пиксель на каждом из каналов изображения домнажается на определённый коэффициент (может быть в диапозоне от 0 до 255), однако, чаще всего он будет лежать в диапозоне от 0 до 2-3. Так как дальнейше увеличение коэффициента будет приводить к множеству пересветов, исключением могут быть изображения достаточно тёмной гаммой. После чего изображение вновь сшивается и получается изображение с большей яркостью ВСЕХ присутсвующих на ней пикселей.
&ensp; Результат работы данного фильтра представлен на изображении ниже.


## Корректировка освещения (гамма)
&ensp; Данный метод использует параметр "гамма" (?) для нелинейного изменения яркости пикселей. В то время как коэффициент равномерно осветляет или затемняет все пиксели, гамма-коррекция изменяет яркость по степенной функции. Если ? меньше 1, то темные пиксели становятся значительно ярче, а светлые меняются мало. Если ? больше 1, то светлые пиксели затемняются сильнее, чем темные. 

&ensp; То есть каждый пиксель будет пересчитываться по формуле: Pix_gamma = 255 * (Pix/ 255) ^ gamma 

&ensp; Где: Pix_gamma - итоговое значение яркости пикселя, Pix - начальное значение яркости пикселя, gamma - коэффициент коррекции.

&ensp; То есть согласно формуле итоговый пиксель нормализуется в диапозон от 0 до 1, после чего возводится в степень гамма, что позволяет осветлять тёмные пиксели или затемнять яркие пиксели. 

&ensp; Результат работы данного фильтра представлен на изображении ниже.


### Корректировка освещения (гистограмма)
&ensp; Данный метод основан на составлении гистграмм для изображения (если речь про ЧБ изображение - для его единственного канала, если же говорить про цветное - то лучше всего будет обратить внимание на все каналы и вывести в отдельности для каждого) и последующего выравнивания гистограммы, с целью избегания выплесков/всплесков (возникновения большого числа пикселей с высокой или низкой яркостью и/или их скопления). Фактически, задача корректроивки через гистограмму постараться скорректроивать аномальные пиксели/их скопления (высокой, средней, низкой части яркости). Например, у нас в изображении могут преобладать тёмные пиксели (левая сторога гистограммы), тогда можно попробвоать сделать плавный переход, путём уменьшения/увеличения  яркости части пикселей (в правой части области низкой яркости или левой части средней яркости).

&ensp; Рассмотрим сразу гистограммы обрабатываемого изображения. Сперва рассмотрим исходные.

![alt text](Image/Гистограмма(до).png)

&ensp; Можно зметить, что в гистограмме синего изображения большая часть пикселей сосредоточена в левой части, что говорит об большом чилсе тёмных пикселей и это проблема, приводящая к перезатемнению изображения. В идеальном решении часть пикселей будет смещена вправо, то есть, их яркость будет увеличена.

&ensp; Аналогичная ситуация в гистограмме зелёного канала.

&ensp; Красный канал имеет небольшую просадку в средней части гистограммы, но в общем и целом - сбалансирован хорошо, относительно других. Ему нужна незначительная корректировка части левых и првых пикселей с смещением в центральную область, чтобы обеспечить плавный переход по яркости на всём изображении.

&ensp; ![alt text](Image/Гистограмма(после).png)

&ensp; Можно заметить, что яркость части пикселей была увеличена и перенесена во многом к центру гистограммы (так как во всех трёх гистограммах проседала средняя часть по числу пикселей).

&ensp; В гистограмме красного цвета было наиболее простой и понятный результат - часть пикселей в средней части получили повышение яркости, и между ними примерно равные промежутки, чтобы среднее значение получалось более сбалансированным по отношению к крайним частям гистограммы.

&ensp; Рассмотрим теперь как эти преобразования выглядят визуально, на изображении, результат обработок представлен ниже.

&ensp; ![alt text](Image/Гистограмма.png)

&ensp; Можно увидеть очень сильное изменение на визуальном восприятии синего канала. Теперь отчётливо видно лицо и прочие элементы изображения, хотя ранее там было сплошное чёрное пятно. Остальные же каналы подверглись куда менее серьёхным изменениям.

&ensp; Рассмотрим исходную и синтезированную гистограмму изображений. Можно заметить, что есть преобладание синего цвета, что, вероятно, вызвано необходимостью в высветлении картинки и сбалансированию её к нейтральным цветам. Итоговая картина выглядат гораздо натуральнее, чеи исходная (пусть и есть не характерный для совмременных изображений синий оттенок на многих участков изображения.


## Бинаризация
&ensp; Данный метод необходим для разбития изображения на два типа пикселей: с минимальной и максимальной яркостью. Решение о переводе пикселя в максимальное или минимальное состояние основывается на том, больше он или меньше чем пороговое значение (выставляется пользвоателем). Для примера, если при пороговом значении в 100 едениц, будет анализирвоаться пиксель яркостью 101, то он будет светылм пикселем с яркостью 255 (белый), а если будет анализироваться пиксель 99, то он будет перекрашен в яркость 0 (чёрный цвет). Цвета белый и чёрный условные для каждого канала, вместо белого для каждого канала будет идти цвет канала.

##  Результаты работы
&ensp; В рамках данной работы были изучены теорретически и реализованы в коде фильтры изображений, согласно поставленной задачи. Были созданы материалы, показывающие этапы работы фильтров, а так же позволяюще сравнить начальное и обработанное изображение после применения каждого из фильтров.

&ensp; Все результаты работы были оформлены в проекте на платформе GitHub, при этом сам код фильтров был реализован на платформе Colab (файл с кодами содержится в репрезитории на GitHub).
