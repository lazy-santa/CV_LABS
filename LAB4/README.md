# **Лаборатораня работа №4 по дисциплине "Системы компьютерного зрения"**

## Задание
В рамках данной работы было необходимо обучить модель с любой архитектурой на наш выбор. Задача модели - находить, определять несколько классов объектов на изображении.


## Выбор датасета 
Был выбран датасет состоящий из фоток самоллетов, кораблей и машин. Датасет содержит по 1000 изображений каждого класса. Датасет не имеет локализационных меток (то есть не имеет координат объектов на изображении, только метки классов).

## Выбор архитектуры модели
Выбор модели для задачи классификации состоит из двух направлений:

1) Использование уже готовой архитектуры

2) Создание своей архитектуры

Рассмотрим первый случай, уже обученной модели на похожих данных. В частности, будет необходим выбор архитектуры непосредственно для задачи классификации транспорта, среди самых популярных можно отметить:

1) ResNet-18/50
    - Подходит для быстрой и стабильной классификации, включая transfer learning
    - Хорошо работает «из коробки»
    - 

2) EfficientNet B0-B3 (Одновременное масштабирование ширины, глубины и разрешения (compound scaling))

3) MobileNetV2/V3 (более быстрая архитектура, но при этом жертвует точностью)

4) DenseNet (Полная связанность — каждый слой получает входы от всех предыдущих, эффективное переиспользование признаков)

Все перечисленные архитектуры предобучены на датасете ImageNet-1k, включающий такие классы:
- Car: race car, racing car, freight car, passenger car;
- Ship: container ship, pirate ship, aircraft carrier, attack aircraft carrier, fireboat, liner, ocean liner;
- Airplanes: airliner, plane, warplane, military plane.


На основе выше указанной информации была выбрана архитектура ResNet18, так как она является одной из наиболе быстродейсвующих.

### Описание архитектуры ResNet
ResNet (сокр. от Residual Network) — это архитектура глубоких нейронных сетей, предложенная в 2015 году исследователями из Microsoft Research. Она стала прорывом в области обучения сверхглубоких сетей (сотни слоёв) благодаря введению остаточных соединений (residual connections).

С момента публикации ResNet-50 стал де-факто стандартом для классификационных задач, особенно в задачах transfer learning. Семейство моделей включает ResNet-18, 34, 50, 101, 152 и более глубокие варианты.

## Архитектура модели ResNet
Модель состоит из нескольких этапов (stages), каждый из которых состоит из набора residual-блоков. Структура представлена ниже на примере ResNet-50:
### Backbone: Свёрточная сетевая часть 
Основная сеть для извлечения признаков, построенная на принципах **CSP (Cross Stage Partial)**.  
- **CSP-блоки**:  
  - Разделяют входные данные на две ветви:  
    - Основная ветвь проходит через серию сверточных слоев.  
    - Побочная ветвь объединяется с основной через конкатенацию.  
  - Уменьшают объем вычислений на 20–30% за счет оптимизации градиентного потока.  
- **SPPF (Spatial Pyramid Pooling Fast)**:  
  - Агрегирует признаки разных масштабов через последовательные слои MaxPooling (5×5, 9×9, 13×13).  
  - Позволяет модели эффективно работать с объектами любого размера.  

### Neck: PAN-FPN  
Слой для комбинирования признаков из разных уровней сети:  
- **FPN (Feature Pyramid Network)**:  
  - Передает семантически насыщенные признаки (например, форму объекта) от глубоких слоев к мелким.  
- **PAN (Path Aggregation Network)**:  
  - Передает пространственные признаки (например, текстуру) от мелких слоев к глубоким.  
- **Масштабирование**:  
  - Модель работает с тремя разрешениями карт признаков (80×80, 40×40, 20×20), что улучшает детекцию мелких и крупных объектов.  

### Head: Anchor-Free  
Головная часть модели, ответственная за предсказание координат и классов объектов:  
- **Прямое предсказание**:  
  - Координаты центра (x, y) относительно grid-ячейки.  
  - Ширина и высота (w, h) относительно всего изображения.  
  - Уверенность (confidence) в наличии объекта.  
  - Вероятности классов через функцию softmax.  

Компоненты архитектуры
 Backbone: Свёрточная сетевая часть

Содержит основные сверточные слои, сгруппированные в стадии

Используется для извлечения признаков разной абстракции

?? Shortcut-соединения

Используются для объединения входа и выхода блока

Позволяют избежать исчезающих градиентов

Global Average Pooling

Преобразует пространственную карту признаков в вектор признаков перед полносвязным слоем
